- name: Dockerfile
  hosts: localhost
  connection: local
  tasks:
     - name: Install repositories packages
       yum:
         name: "{{ item }}"
         state: present
       with_items:
         - https://centos7.iuscommunity.org/ius-release.rpm 
         - http://download.gluster.org/pub/gluster/glusterfs/3.7/3.7.10/CentOS/glusterfs-epel.repo
        


     - name: Install repositories packages
       yum:
         name: "{{ item }}"
         state: present
       with_items:
         - php56u
         - php56u-opcache
         - mariadb
         - glusterfs
         - glusterfs-fuse
         - wget
         - vim
         - httpd
         - php56u-mysqlnd
         - php56u-pdo
         - php56u-ldap
         - php56u-mbstring
         - php56u-mcrypt
         - php56u-soap
         - php56u-dba
         - php56u-pecl-memcached
         - php56u-pecl-igbinary
         - php56u-pecl-memcache
         - php56u-bcmath
         - php56u-tidy
         - php56u-gd
         - php56u-xmlrpc
         - memcached
   
     - name: Download Drush executable
       get_url: 
         url: http://files.drush.org/drush.phar
         dest: /usr/local/bin/drush

     - name: Add exectable to drush
       file:
         path: /usr/local/bin/drush
         mode: 0750 
     
     - name: Setup global drush permissions
       file:
         state: directory
         path: /usr/share/drush/commands
         mode: 0755

     - name: Create a docroot
       file:
         path: /var/www/html      
         owner: apache
         group: apache
         state: directory

     - name: Create a edit vhost 
       template: 
         src: edit-vhosts.conf 
         dest: /etc/httpd/conf.d/edit-vhost.conf 
         owner: root 
         group: root
         mode: 0644
   

     - name: Create an public vhost
       template:
         src: public-vhosts.conf
         dest: /etc/httpd/conf.d/public-vhost.conf
         owner: root
         group: root
         mode: 0644




   #  - name: Deploy httpd.conf

   #  - name: Deploy certificates

   #  - name: Deploy generic settings.php

   #  - name: Deploy drush.ini

   #  - name: Deploy php.ini
   #  - name: Deploy apc.ini??
    # - name: Download drush rr
    #   command: /usr/local/bin/drush dl -y registry_rebuild --destination /usr/share/drush/commands
       
   #  - name: Set gluster mount point
   #  - name: Checkout code from git
   #  - name: Deploy setting configuration 
